<!doctype html>
<html lang="sv">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Todo (en fil, utan kommentarer)</title>
  <style>
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body { margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; background: linear-gradient(to top, #ff0000, #ffffff); background-attachment: fixed; color: #e5e7eb; }
    .page { min-height: 100%; display: flex; align-items: center; justify-content: center; padding: 24px; }
    .card { width: 100%; max-width: 520px; background: rgba(2,6,23,0.65); border: 1px solid rgba(255,255,255,0.08); border-radius: 16px; box-shadow: 0 12px 40px rgba(0,0,0,0.35); overflow: hidden; opacity: 1; transform: translateY(0); }
    .card.page-visible { animation: pageDropIn 0.6s cubic-bezier(.16,1,.3,1) forwards; }
    @keyframes pageDropIn { from { opacity: 0; transform: translateY(-50px); } to { opacity: 1; transform: translateY(0); } }
    .header { padding: 18px 20px 10px; border-bottom: 1px solid rgba(255,255,255,0.08); }
    .title { margin: 0; font-size: 22px; font-weight: 700; }
    .subtitle { margin: 6px 0 0; font-size: 13px; color: #94a3b8; }
    .row { display: flex; gap: 8px; padding: 14px 16px; align-items: flex-start; }
    .textBox { flex: 1; border-radius: 10px; border: 1px solid rgba(255,255,255,0.08); padding: 12px 14px; background: rgba(15,23,42,0.65); color: #e5e7eb; outline: none; font-size: 15px; }
    .textBox:focus { border-color: rgba(56,189,248,0.7); box-shadow: 0 0 0 2px rgba(56,189,248,0.35); }
    .okButton { background: #38bdf8; color: #0f172a; border: none; padding: 12px 14px; border-radius: 10px; font-weight: 600; cursor: pointer; }
    .okButton:active { transform: scale(0.98); }
    .errorText { margin: 4px 16px 0; font-size: 13px; color: #fca5a5; opacity: 0; height: 0; overflow: hidden; }
    .errorText.visible { opacity: 1; height: auto; }
    .textBox.errorBlink { animation: blinkRed 0.5s ease-in-out 1; }
    @keyframes blinkRed { 0%{ box-shadow: 0 0 0 0 rgba(248,113,113,0.8); border-color: #f87171;} 50%{ box-shadow: 0 0 0 3px rgba(248,113,113,0.35);} 100%{ box-shadow: 0 0 0 0 rgba(248,113,113,0.0);} }
    .stats { display: flex; justify-content: space-between; align-items: center; color: #94a3b8; font-size: 12px; padding: 0 16px 10px; }
    .clearAll { font-size: 12px; color: #cbd5e1; background: transparent; border: none; text-decoration: underline; text-underline-offset: 2px; cursor: pointer; }
    .list { padding: 0; margin: 0; list-style: none; border-top: 1px solid rgba(255,255,255,0.06); }
    .todoItem { display: flex; align-items: center; gap: 10px; padding: 12px 14px; border-bottom: 1px solid rgba(255,255,255,0.06); user-select: none; cursor: pointer; }
    .todoBullet { height: 20px; width: 20px; border-radius: 999px; border: 1px solid rgba(255,255,255,0.25); background: transparent; pointer-events: none; }
    .todoText { flex: 1; font-size: 15px; transition: color 0.35s ease, opacity 0.35s ease; }
    .todoItem.done .todoText { color: #9ca3af; text-decoration: line-through; opacity: 0.9; }
    .todoItem.done .todoBullet { background: #34d399; border-color: #34d399; }
    .deleteBtn { background: transparent; border: 1px solid rgba(255,255,255,0.15); color: #e5e7eb; border-radius: 8px; padding: 6px 8px; cursor: pointer; opacity: 0.85; }
    .deleteBtn:hover { opacity: 1; }
    .justAdded { animation: itemPopIn 0.35s ease-out both; }
    @keyframes itemPopIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
  </style>
</head>
<body>
  <div class="page">
    <div id="todoCard" class="card page-visible">
      <div class="header">
        <h1 class="title">My Todo List</h1>
        <p class="subtitle">En fil, enkla lösningar.</p>
      </div>
      <div class="row">
        <input id="todoInputBox" class="textBox" placeholder="Vad behöver göras?" />
        <button id="okButton" class="okButton">OK</button>
      </div>
      <p id="errorText" class="errorText">Skriv något innan du lägger till.</p>
      <div class="stats">
        <div>Klarmarkeringar: <b id="completedCounter">0</b></div>
        <div>Kvar: <b id="remainingCounter">0</b></div>
        <button id="clearAll" class="clearAll" type="button">Rensa alla</button>
      </div>
      <ul id="todoList" class="list"></ul>
    </div>
  </div>
  <script>
    var todoArrayWithAllItems = [];
    var completedCountOnlyGoesUp = 0;
    var elCard = document.getElementById('todoCard');
    var elInput = document.getElementById('todoInputBox');
    var elOk = document.getElementById('okButton');
    var elList = document.getElementById('todoList');
    var elError = document.getElementById('errorText');
    var elCompleted = document.getElementById('completedCounter');
    var elRemaining = document.getElementById('remainingCounter');
    var elClearAll = document.getElementById('clearAll');
    window.addEventListener('DOMContentLoaded', function(){
      elCard.classList.remove('page-visible');
      setTimeout(function(){ elCard.classList.add('page-visible'); }, 10);
      elInput.focus();
    });
    function rebuildCountersInline(){
      var remainingNow = 0;
      for (var i = 0; i < todoArrayWithAllItems.length; i++) {
        if (!todoArrayWithAllItems[i].done) { remainingNow++; }
      }
      elRemaining.textContent = String(remainingNow);
      elCompleted.textContent = String(completedCountOnlyGoesUp);
    }
    elOk.addEventListener('click', function(){
      var typed = (elInput.value || '').trim();
      if (!typed) {
        elError.classList.add('visible');
        elInput.classList.add('errorBlink');
        setTimeout(function(){ elInput.classList.remove('errorBlink'); }, 500);
        return;
      }
      elError.classList.remove('visible');
      var newItem = { id: Math.random().toString(36).slice(2) + Date.now().toString(36), text: typed, done: false };
      todoArrayWithAllItems.unshift(newItem);
      var li = document.createElement('li');
      li.className = 'todoItem justAdded';
      li.setAttribute('data-id', newItem.id);
      var bullet = document.createElement('div'); bullet.className = 'todoBullet'; li.appendChild(bullet);
      var textDiv = document.createElement('div'); textDiv.className = 'todoText'; textDiv.textContent = newItem.text; li.appendChild(textDiv);
      var del = document.createElement('button'); del.className = 'deleteBtn'; del.type = 'button'; del.textContent = 'Delete'; li.appendChild(del);
      li.addEventListener('click', function(e){
        if (e.target === del) return;
        for (var i = 0; i < todoArrayWithAllItems.length; i++) {
          if (todoArrayWithAllItems[i].id === newItem.id) {
            var wasDone = todoArrayWithAllItems[i].done;
            todoArrayWithAllItems[i].done = !todoArrayWithAllItems[i].done;
            if (!wasDone && todoArrayWithAllItems[i].done) { completedCountOnlyGoesUp++; }
            break;
          }
        }
        while (elList.firstChild) { elList.removeChild(elList.firstChild); }
        for (var j = 0; j < todoArrayWithAllItems.length; j++) {
          var it = todoArrayWithAllItems[j];
          var li2 = document.createElement('li');
          li2.className = 'todoItem' + (it.done ? ' done' : '');
          li2.setAttribute('data-id', it.id);
          var b2 = document.createElement('div'); b2.className = 'todoBullet'; li2.appendChild(b2);
          var t2 = document.createElement('div'); t2.className = 'todoText'; t2.textContent = it.text; li2.appendChild(t2);
          var d2 = document.createElement('button'); d2.className = 'deleteBtn'; d2.type = 'button'; d2.textContent = 'Delete'; li2.appendChild(d2);
          (function(storeId){
            li2.addEventListener('click', function(ev){
              if (ev.target === d2) return;
              for (var k = 0; k < todoArrayWithAllItems.length; k++) {
                if (todoArrayWithAllItems[k].id === storeId) {
                  var was = todoArrayWithAllItems[k].done;
                  todoArrayWithAllItems[k].done = !todoArrayWithAllItems[k].done;
                  if (!was && todoArrayWithAllItems[k].done) { completedCountOnlyGoesUp++; }
                  break;
                }
              }
              while (elList.firstChild) { elList.removeChild(elList.firstChild); }
              for (var m = 0; m < todoArrayWithAllItems.length; m++) {
                var it3 = todoArrayWithAllItems[m];
                var li3 = document.createElement('li');
                li3.className = 'todoItem' + (it3.done ? ' done' : '');
                li3.setAttribute('data-id', it3.id);
                var b3 = document.createElement('div'); b3.className = 'todoBullet'; li3.appendChild(b3);
                var t3 = document.createElement('div'); t3.className = 'todoText'; t3.textContent = it3.text; li3.appendChild(t3);
                var d3 = document.createElement('button'); d3.className = 'deleteBtn'; d3.type = 'button'; d3.textContent = 'Delete'; li3.appendChild(d3);
                (function(idForDel){ d3.addEventListener('click', function(){
                  var next = [];
                  for (var n = 0; n < todoArrayWithAllItems.length; n++) {
                    if (todoArrayWithAllItems[n].id !== idForDel) next.push(todoArrayWithAllItems[n]);
                  }
                  todoArrayWithAllItems = next;
                  while (elList.firstChild) { elList.removeChild(elList.firstChild); }
                  for (var p = 0; p < todoArrayWithAllItems.length; p++) {
                    var itm = todoArrayWithAllItems[p];
                    var li4 = document.createElement('li');
                    li4.className = 'todoItem' + (itm.done ? ' done' : '');
                    li4.setAttribute('data-id', itm.id);
                    var b4 = document.createElement('div'); b4.className = 'todoBullet'; li4.appendChild(b4);
                    var t4 = document.createElement('div'); t4.className = 'todoText'; t4.textContent = itm.text; li4.appendChild(t4);
                    var d4 = document.createElement('button'); d4.className = 'deleteBtn'; d4.type = 'button'; d4.textContent = 'Delete'; li4.appendChild(d4);
                    elList.appendChild(li4);
                  }
                  rebuildCountersInline();
                }); })(it3.id);
                elList.appendChild(li3);
              }
              rebuildCountersInline();
            });
          })(it.id);
          (function(idForImmediateDel){
            d2.addEventListener('click', function(){
              var arr = [];
              for (var z = 0; z < todoArrayWithAllItems.length; z++) {
                if (todoArrayWithAllItems[z].id !== idForImmediateDel) arr.push(todoArrayWithAllItems[z]);
              }
              todoArrayWithAllItems = arr;
              while (elList.firstChild) { elList.removeChild(elList.firstChild); }
              for (var y = 0; y < todoArrayWithAllItems.length; y++) {
                var it2 = todoArrayWithAllItems[y];
                var liY = document.createElement('li');
                liY.className = 'todoItem' + (it2.done ? ' done' : '');
                liY.setAttribute('data-id', it2.id);
                var bY = document.createElement('div'); bY.className = 'todoBullet'; liY.appendChild(bY);
                var tY = document.createElement('div'); tY.className = 'todoText'; tY.textContent = it2.text; liY.appendChild(tY);
                var dY = document.createElement('button'); dY.className = 'deleteBtn'; dY.type = 'button'; dY.textContent = 'Delete'; liY.appendChild(dY);
                (function(idDelY){ dY.addEventListener('click', function(){
                  var tmp = [];
                  for (var u = 0; u < todoArrayWithAllItems.length; u++) {
                    if (todoArrayWithAllItems[u].id !== idDelY) tmp.push(todoArrayWithAllItems[u]);
                  }
                  todoArrayWithAllItems = tmp;
                  while (elList.firstChild) { elList.removeChild(elList.firstChild); }
                  for (var v = 0; v < todoArrayWithAllItems.length; v++) {
                    var itt = todoArrayWithAllItems[v];
                    var liV = document.createElement('li');
                    liV.className = 'todoItem' + (itt.done ? ' done' : '');
                    liV.setAttribute('data-id', itt.id);
                    var bV = document.createElement('div'); bV.className = 'todoBullet'; liV.appendChild(bV);
                    var tV = document.createElement('div'); tV.className = 'todoText'; tV.textContent = itt.text; liV.appendChild(tV);
                    var dV = document.createElement('button'); dV.className = 'deleteBtn'; dV.type = 'button'; dV.textContent = 'Delete'; liV.appendChild(dV);
                    elList.appendChild(liV);
                  }
                  rebuildCountersInline();
                }); })(it2.id);
                elList.appendChild(liY);
              }
              rebuildCountersInline();
            });
          })(it.id);
          elList.appendChild(li2);
        }
        rebuildCountersInline();
      });
      (function(idForDelInit){
        del.addEventListener('click', function(){
          var arr2 = [];
          for (var a = 0; a < todoArrayWithAllItems.length; a++) {
            if (todoArrayWithAllItems[a].id !== idForDelInit) arr2.push(todoArrayWithAllItems[a]);
          }
          todoArrayWithAllItems = arr2;
          while (elList.firstChild) { elList.removeChild(elList.firstChild); }
          for (var b = 0; b < todoArrayWithAllItems.length; b++) {
            var it0 = todoArrayWithAllItems[b];
            var li0 = document.createElement('li');
            li0.className = 'todoItem' + (it0.done ? ' done' : '');
            li0.setAttribute('data-id', it0.id);
            var bb = document.createElement('div'); bb.className = 'todoBullet'; li0.appendChild(bb);
            var tt = document.createElement('div'); tt.className = 'todoText'; tt.textContent = it0.text; li0.appendChild(tt);
            var dd = document.createElement('button'); dd.className = 'deleteBtn'; dd.type = 'button'; dd.textContent = 'Delete'; li0.appendChild(dd);
            elList.appendChild(li0);
          }
          rebuildCountersInline();
        });
      })(newItem.id);
      elList.insertBefore(li, elList.firstChild);
      setTimeout(function(){ li.classList.remove('justAdded'); }, 400);
      elInput.value = '';
      elInput.focus();
      rebuildCountersInline();
    });
    elInput.addEventListener('keydown', function(e){ if (e.key === 'Enter') elOk.click(); });
    elInput.addEventListener('input', function(){ elError.classList.remove('visible'); });
    elClearAll.addEventListener('click', function(){
      todoArrayWithAllItems = [];
      while (elList.firstChild) { elList.removeChild(elList.firstChild); }
      rebuildCountersInline();
    });
    rebuildCountersInline();
  </script>
</body>
</html>
